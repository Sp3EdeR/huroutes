name: 'Build huroutes'
description: 'Builds the huroutes website from source'
runs:
  using: 'composite'
  steps:
    - name: Minify the website code
      shell: bash
      run: |
          sudo pip install minify-html==0.15.0
          sudo pip install rjsmin==1.2.3
          sudo pip install rcssmin==1.2.0
          sudo pip install lxml==5.3.0
          python ".github/scripts/optimize-site.py" .
    - name: Download curves data
      # This step downloads and converts autogenerated curvature data for a map overlay.
      # The script supports processing KMZ files provided by kml.roadcurvature.com. "Curve" KMZ format is not supported.
      shell: bash
      run: |
          sudo pip install kml2geojson==5.1.0
          python ".github/scripts/get-curve-map.py" "https://kml.roadcurvature.com/europe/hungary.c_1000.kmz" "map/curves.geo.json" "map/curves-style.json"
