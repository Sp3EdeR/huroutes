(function(){cacheNames={thirdparty:"thirdparty-v3",static:"static-v2",dynamic:"dynamic-v1"};const fetchWithTimeout=(request,timeoutMs=1000)=>{const controller=new AbortController();const timeoutId=setTimeout(()=>controller.abort(new DOMException("Fetch timeout for "+request.url,"TimeoutError")),timeoutMs);return fetch(request,{signal:controller.signal}).finally(()=>clearTimeout(timeoutId));};self.addEventListener('activate',e=>{cacheIds=Object.keys(cacheNames).map(key=>cacheNames[key]);e.waitUntil(caches.keys().then(names=>names.filter(name=>!cacheIds.includes(name))).then(names=>Promise.all(names.map(name=>caches.delete(name)))).then(()=>self.clients.claim()));});self.addEventListener('fetch',e=>{const isResponseCompatible=(req,resp)=>{return resp&&(resp.type!=='opaque'||req.mode==='no-cors')&&(resp.type!=='opaqueredirect'||req.mode==='manual')&&(resp.type!=='cors'||req.mode!=='same-origin');}
const matchCompatibleResponse=(cache,request)=>cache.match(request.url).then(response=>{if(!response)return null;if(isResponseCompatible(request,response))return response;return cache.delete(request).then(()=>null);});const cacheFirstLogic=cache=>matchCompatibleResponse(cache,e.request).then(cachedResponse=>cachedResponse||fetch(e.request).then(response=>{cache.put(e.request,response.clone());return response;}));const cacheFirst=cacheName=>caches.open(cacheName).then(cacheFirstLogic);const netFirst=cacheName=>caches.open(cacheName).then(cache=>{return fetchWithTimeout(e.request,1000).then(response=>{cache.put(e.request,response.clone());return response;}).catch(error=>error.name==='TimeoutError'||error.name==='AbortError'?cacheFirstLogic(cache):matchCompatibleResponse(cache,e.request).then(response=>{if(response)return response;throw error;}));});const url=new URL(e.request.url);if(url.origin==self.location.origin)
{if(e.request.destination==='image')
return e.respondWith(cacheFirst(cacheNames.static));return e.respondWith(netFirst(cacheNames.dynamic));}
if(url.hostname=="cdn.jsdelivr.net")
return e.respondWith(cacheFirst(cacheNames.thirdparty));});})();